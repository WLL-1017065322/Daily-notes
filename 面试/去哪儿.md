

# 1课程介绍：

![1557075395609](assets/1557075395609.png)





![1557075408071](assets/1557075408071.png)



![1557075420655](assets/1557075420655.png)





![1557075432360](assets/1557075432360.png)



![1557075445753](assets/1557075445753.png)





![1557075461216](assets/1557075461216.png)





# 2Vue起步：

1，看官方文档

2，hello world



## vue小demo

![1557075668285](assets/1557075668285.png)









```js
    <script src="https://cdn.jsdelivr.net/npm/vue"></script>
</head>

<body>
    <div id="app">
        <input type="text" v-model="txt">
        <button class="btn" v-on:click="submit">提交</button>

        <ul>
            <li v-for="(item,index) in list" :key="index">{{item}}</li>
        </ul>
    </div>

</body>

<script>
    var vm = new Vue({
        el: '#app',
        data: {
            txt: '',
            list: [],
        },
        methods: {
            submit: function () {
                // console.log(this.txt)
                if(this.txt !== ""){
                this.list.push(this.txt)
                this.txt = ''
                }
            }
        }
    })
</script>
```





## mvp

![1557076964488](assets/1557076964488.png)



## jquery

 m 模型层 v 视图p 控制器





![1557077133211](assets/1557077133211.png)



## mvvm

m：data v：div上面  vm：

![1557077258258](assets/1557077258258.png)





前端组件化：

组件化思想修改小demo





## 全局组件/局部组件：

```

<body>
    <div id="app">
        <input type="text" v-model="txt">
        <button class="btn" v-on:click="submit">提交</button>

        <ul>
            <!-- <li v-for="(item,index) in list" :key="index">{{item}}</li> -->
            <list-to v-bind:content="item" v-for="(item,index) in list" :key="index"></list-to>
        </ul>
    </div>

</body>



<script>
    //全局组件===================================
    // Vue.component("listTo", {
    //     props: ['content'],  //组件间传值
    //     template: "<li>{{content}}</li>"
    // })
    //局部组件==================================
    var listTo = {
        props: ['content'],
        template: "<li>{{content}}</li>"

    }

    var vm = new Vue({
        el: '#app',
        data: {
            txt: '',
            list: [],
        },

        components: {
            listTo: listTo//=== 挂载
        },

        methods: {
            submit: function () {
                // console.log(this.txt)
                if (this.txt !== "") {
                    this.list.push(this.txt)
                    this.txt = ''
                }
            }
        }
    })
</script>

```







## 父子传值：

![1557419428719](assets/1557419428719.png)



```js
<body>
    <div id="app">
        <input type="text" v-model="txt">
        <button class="btn" v-on:click="submit">提交</button>

        <ul>
            <!-- <li v-for="(item,index) in list" :key="index">{{item}}</li> -->
            <list-to v-bind:content="item" v-for="(item,index) in list" :key="index" @delete="listToClick"></list-to>//================
        </ul>
    </div>

</body>

<script>
    //全局组件
    // Vue.component("listTo", {
    //     props: ['content'],
    //     template: "<li>{{content}}</li>"
    // })
    var listTo = {
        props: ['content'],
        template: "<li v-on:click='listToClick'>{{content}}</li>",//===
       methods: {
        listToClick:function(){
            this.$emit("delete",this.index);//========
        }
       },

    }

    var vm = new Vue({
        el: '#app',
        data: {
            txt: '',
            list: [],
        },

        components: {
            listTo: listTo
        },

        methods: {
            submit: function () {
                // console.log(this.txt)
                if (this.txt !== "") {
                    this.list.push(this.txt)
                    this.txt = ''
                }
            },
            listToClick:function(index){//========
               this.list.splice(index,1)
            }
        }
    })
</script>
```



# 3基础精讲

vm.$data

vm.$el

vm.$destory()



## 声明周期钩子：

![f847b38a-63fe-11e6-9c29-38e58d46f036.png](assets/3346068135-580822cd52898_articlex.png)

beforeCreate:

**beforeCreate（新对象诞生）**

Vue对象用新方法实例化。它创建一个Vue类的对象来处理DOM元素。对象的这个生命阶段可以通过beforeCreated 挂钩来访问   。我们可以在这个钩子中插入我们的代码，在对象初始化之前执行。



created

**创建（具有默认特性的对象）**

在这个生命阶段，对象及其事件完全初始化。 created 是访问这个阶段并编写代码的钩子。



beforeMount

**beforeMounted（对象在DOM中适合形状）**

这个钩子被调用  beforeMounted。在这个阶段，它检查是否有任何模板可用于要在DOM中呈现的对象。如果没有找到模板，那么它将所定义元素的外部HTML视为模板。



mounted

**已安装（DOM已准备就绪并放置在页面内）**

一旦模板准备就绪。它将数据放入模板并创建可呈现元素。用这个新的数据填充元素替换DOM元素。这一切都发生在mounted钩子上。



beforeUpdate

**beforeUpdate（更改已完成，但尚未准备好更新DOM）**

在外部事件/用户输入beforeUpdate发生更改时，此钩子即  在反映原始DOM元素的更改之前被触发。

为了解决这个问题  beforeUpdated，我添加了下面的代码。它通过更新DOM来更改运行时中的hello_message。



updated

**更新（在DOM中呈现的更改）**

然后，通过实际更新DOM对象并触发updated，屏幕上的变化得到呈现  。





beforeDestory

**beforeDestroy（对象准备死掉）**

就在Vue对象被破坏并从内存中释放之前，  deforeDestroy 钩子被触发，并允许我们在其中处理我们的自定义代码。

为了激发这个钩子，我添加了下面的代码来销毁Vue对象。



destroyed

**销毁（对象停止并从内存中删除）**

该  destroyed 钩子被成功运行销毁对象上调用。



![clipboard.png](assets/3504099265-580628fd03258_articlex.png)

 

```js
<!DOCTYPE html>
<html>
<head>
    <title></title>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/vue/2.1.3/vue.js"></script>
</head>
<body>

<div id="app">
     <p>{{ message }}</p>
</div>

<script type="text/javascript">
    
  var app = new Vue({
      el: '#app',
      data: {
          message : "xuxiao is boy" 
      },
       beforeCreate: function () {
                console.group('beforeCreate 创建前状态===============》');
               console.log("%c%s", "color:red" , "el     : " + this.$el); //undefined
               console.log("%c%s", "color:red","data   : " + this.$data); //undefined 
               console.log("%c%s", "color:red","message: " + this.message)  
        },
        created: function () {
            console.group('created 创建完毕状态===============》');
            console.log("%c%s", "color:red","el     : " + this.$el); //undefined
               console.log("%c%s", "color:red","data   : " + this.$data); //已被初始化 
               console.log("%c%s", "color:red","message: " + this.message); //已被初始化
        },
        beforeMount: function () {
            console.group('beforeMount 挂载前状态===============》');
            console.log("%c%s", "color:red","el     : " + (this.$el)); //已被初始化
            console.log(this.$el);
               console.log("%c%s", "color:red","data   : " + this.$data); //已被初始化  
               console.log("%c%s", "color:red","message: " + this.message); //已被初始化  
        },
        mounted: function () {
            console.group('mounted 挂载结束状态===============》');
            console.log("%c%s", "color:red","el     : " + this.$el); //已被初始化
            console.log(this.$el);    
               console.log("%c%s", "color:red","data   : " + this.$data); //已被初始化
               console.log("%c%s", "color:red","message: " + this.message); //已被初始化 
        },
        beforeUpdate: function () {
            console.group('beforeUpdate 更新前状态===============》');
            console.log("%c%s", "color:red","el     : " + this.$el);
            console.log(this.$el);   
               console.log("%c%s", "color:red","data   : " + this.$data); 
               console.log("%c%s", "color:red","message: " + this.message); 
        },
        updated: function () {
            console.group('updated 更新完成状态===============》');
            console.log("%c%s", "color:red","el     : " + this.$el);
            console.log(this.$el); 
               console.log("%c%s", "color:red","data   : " + this.$data); 
               console.log("%c%s", "color:red","message: " + this.message); 
        },
        beforeDestroy: function () {
            console.group('beforeDestroy 销毁前状态===============》');
            console.log("%c%s", "color:red","el     : " + this.$el);
            console.log(this.$el);    
               console.log("%c%s", "color:red","data   : " + this.$data); 
               console.log("%c%s", "color:red","message: " + this.message); 
        },
        destroyed: function () {
            console.group('destroyed 销毁完成状态===============》');
            console.log("%c%s", "color:red","el     : " + this.$el);
            console.log(this.$el);  
               console.log("%c%s", "color:red","data   : " + this.$data); 
               console.log("%c%s", "color:red","message: " + this.message)
        }
    })
</script>
</body>
</html>
```

## vue模板语法：

插值表达式 {{msg}}

v-text

v-html



## 计算属性，方法和侦听器

### 计算属性：computed:{

}

![1557126686977](assets/1557126686977.png)

计算缓存



### 计算方法：

没有缓存

![1557126900506](assets/1557126900506.png)

### 侦听器：watch：{

}

会有缓存



![1557126968824](assets/1557126968824.png)



## 计算属性的setter个getter



![1557127073596](assets/1557127073596.png)







![1557127122161](assets/1557127122161.png)



## vue的样式绑定

isActivated

：class=“{activated：isActivated}”

data:{

isActivated:true/false

}



class:

![1557127401357](assets/1557127401357.png)

![1557127435786](assets/1557127435786.png)





![1557127453622](assets/1557127453622.png)





style:对象/数组



![1557127576158](assets/1557127576158.png) 





![1557127632353](assets/1557127632353.png)





![1557127721718](assets/1557127721718.png)





## vue中条件渲染

v-if：

![1557127835330](assets/1557127835330.png)

v-else：

v-else-if：

![1557128026490](assets/1557128026490.png)



v-show：存在

![1557127885460](assets/1557127885460.png)



key值的使用：

防止复用



![1557128094861](assets/1557128094861.png)



## 列表渲染：

数组循环

![1557128167802](assets/1557128167802.png)



key值：不推荐用index

性能最优

![1557128274934](assets/1557128274934.png)



修改数组不能通过修改下标的方式：



1只能通过vue提供的  push pop shift unshift  splice sort reverse

 

![1557128475133](assets/1557128475133.png)



2改变数组的引用地址：



template 占位符，不会渲染到页面

![1557128599469](assets/1557128599469.png)





对象的循环

![1557128692099](assets/1557128692099.png)





![1557128715407](assets/1557128715407.png)

通过修改引用添加数据：

![1557128763104](assets/1557128763104.png)





## vue中的set方法

对象：

**![1557128834784](assets/1557128834784.png)**



实例方法：

![1557128886555](assets/1557128886555.png)





数组：

![1557128992393](assets/1557128992393.png)



总结：

改变数组数据，页面跟着变：1，改变引用，2使用变异方法，3set

改变对象数据，页面跟着变：1，改变引用，2set







# 4深入了解组件

## 组件使用细节

1is解决bug

![1557129202881](assets/1557129202881.png)

解决bug



![1557129233934](assets/1557129233934.png)





![1557129598710](assets/1557129598710.png)





![1557129604489](assets/1557129604489.png)





2子组件的data是一个函数 返回对象

防止各组件数据冲突

![1557129697147](assets/1557129697147.png)





3 ref获取dom节点

![1557129812515](assets/1557129812515.png)





![1557129911925](assets/1557129911925.png)









触发change事件  父组件监听change事件，执行change方法

  ![1557130149226](assets/1557130149226.png)







![1557130136075](assets/1557130136075.png)





div标签上时 获取的是标签的dom元素

组件上写ref  通过t$refs     获取的内容实际上是 counter子组件的一个引用



## 父子组件的数据传递：

1 **父组件通过属性传值**

子组件使用父组件的数据：父组件向字组件传递参数

子组件不能反过来改变父组件的参数

![1557130469430](assets/1557130469430.png)



要改变，自己创建一个数据来保存

 ![1557130691199](assets/1557130691199.png)





2**子组件通过事件触发的形式传值**



![1557133798115](assets/1557133798115.png)



![1557133786834](assets/1557133786834.png)





![1557133816820](assets/1557133816820.png)





## 组件参数校验与非props特性



组件参数校验：

![1557134093606](assets/1557134093606.png)



![1557134181817](assets/1557134181817.png)



自定义校验器：

![1557134233369](assets/1557134233369.png)





非props特性：

1，父传子不接，无法使用父组件的内容

2，属性会展示到子组件最外层的html标签的属性里

![1557134449319](assets/1557134449319.png)





## 组件绑定原生事件



1，在templateli的div加事件

![1557134643819](assets/1557134643819.png)



2在child加事件

父组件的事件无法触发：

![1557134700534](assets/1557134700534.png)





3 监听child的原生点击事件 .native



![1557134828888](assets/1557134828888.png)





## 非父子组件间的传值（Bus/总线/发布订阅模式/观察者模式）

![1557134877617](assets/1557134877617.png)   

​    



![1557156491642](assets/1557156491642.png) 

​     

![1557156505700](assets/1557156505700.png)

![1557156520022](assets/1557156520022.png)





```js
<body>
    <div id="app">
        <first-child content="111"> </first-child>
        <first-child content="222"> </first-child>
        
        
    </div>
    
    
</body>
<script>
    Vue.prototype.bus = new Vue()

    Vue.component('firstChild',{
        data:function(){
            return {
                childContent:this.content

            }
        },
        props:{
            content:String
        },
        template:'<div @click="func">{{childContent}}</div>',
        methods:{
            func(){
                console.log(this.childContent)
                this.bus.$emit('change',this.childContent)
            }
        },
        mounted() {
            var that=this
            this.bus.$on('change',function(msg){
                that.childContent = msg

            })
            
        },
    })

    var vm =new Vue({
        el:'#app',
        data:{
            
        },
        methods: {
            
        },
        
    })

</script>
```





## vue使用插槽



![1557158512435](assets/1557158512435.png)



这种情况会 多一个div template不好用



solt

![1557158609911](assets/1557158609911.png)

![1557158669676](assets/1557158669676.png)



![1557158685869](assets/1557158685869.png)



![1557158781895](assets/1557158781895.png)



![1557158771101](assets/1557158771101.png)

具名插槽：

![1557158813042](assets/1557158813042.png)

## vue作用域插槽



![1557159246978](assets/1557159246978.png)



v-slot="props"

父组件调用子组件的时候给子组件传了一个作用域插槽，这个插槽必须是template开头

应用场景：

当子组件循环或者某一部分他的  应该有外界传递进来

![1557158512435](assets/1557158512435.png)



```
<body>

    <div id="app">
        <child>
            //<template slot-scope="props">
            <template v-slot="props">
                <li>{{props.item}}===={{props.index}}</li>
            </template>
        </child>

    </div>




</body>
<script>

    Vue.component('child', {
        data: function () {
            return {
                list: [1, 2, 3, 4]
            }
        },
        template:
         `
         <div>
        <ul>
            <slot v-for='(item,index) in list' :key='index' :item=item :index=index></slot>
        </ul>
        </div>
        `
    })
    var vm = new Vue({
        el: '#app'
    })

</script>
```



## 动态组件和v-once指令：



![1557161118784](assets/1557161118784.png)



![1557161143633](assets/1557161143633.png)



动态组件：

![1557161633921](assets/1557161633921.png)



v-once指令：性能更高

![1557161715028](assets/1557161715028.png)



# 5vue的动画特效

## vue中的动画及原理：



![1557161903270](assets/1557161903270.png)

![1557162408408](assets/1557162408408.png)



Vue 提供了 `transition` 的封装组件，在下列情形中，可以给任何元素和组件添加进入/离开过渡

- 条件渲染 (使用 `v-if`)
- 条件展示 (使用 `v-show`)
- 动态组件
- 组件根节点



```vue
<div id="demo">
  <button v-on:click="show = !show">
    Toggle
  </button>
  <transition name="fade">//去掉name则class:v-enter
    <p v-if="show">hello</p>
  </transition>
</div>
new Vue({
  el: '#demo',
  data: {
    show: true
  }
})
.fade-enter-active, .fade-leave-active {
  transition: opacity .5s;
}
.fade-enter, .fade-leave-to /* .fade-leave-active below version 2.1.8 */ {
  opacity: 0;
}
```



## vue中animate.css库

自定义 transition的class：

![1557162641408](assets/1557162641408.png)





![1557162663309](assets/1557162663309.png)



使用 animate.css

 animated必须要加





![1557162845915](assets/1557162845915.png)





## 在vue同时使用过度和动画：

第一次显示时，即网页刷新启动动画；

![1557163083763](assets/1557163083763.png)





同时：

两种动画的时长，设定：type：transition

![1557163177093](assets/1557163177093.png)

：duration

1

![1557163240701](assets/1557163240701.png)

2

![1557163289728](assets/1557163289728.png)





## vue中的js动画与velocity.js的结合：

注意 动画结束done（）enter leave  有回调

![1557164030993](assets/1557164030993.png)



```js
js钩子
<transition
  v-on:before-enter="beforeEnter"
  v-on:enter="enter"
  v-on:after-enter="afterEnter"

  v-on:enter-cancelled="enterCancelled"

  v-on:before-leave="beforeLeave"
  v-on:leave="leave"
  v-on:after-leave="afterLeave"

  v-on:leave-cancelled="leaveCancelled"
>
  <!-- ... -->
</transition>


// ...
methods: {
  // --------
  // 进入中
  // --------

  beforeEnter: function (el) {
    // ...
  },
  // 当与 CSS 结合使用时
  // 回调函数 done 是可选的
  enter: function (el, done) {
    // ...
    done()
  },
  afterEnter: function (el) {
    // ...
  },
  enterCancelled: function (el) {
    // ...
  },

  // --------
  // 离开时
  // --------

  beforeLeave: function (el) {
    // ...
  },
  // 当与 CSS 结合使用时
  // 回调函数 done 是可选的
  leave: function (el, done) {
    // ...
    done()
  },
  afterLeave: function (el) {
    // ...
  },
  // leaveCancelled 只用于 v-show 中
  leaveCancelled: function (el) {
    // ...
  }
}
```



## vue中多个元素或组件的过渡

多个元素：

![1557164353229](assets/1557164353229.png)

没有动画，dom复用

当有**相同标签名**的元素切换时，需要通过 `key` 特性设置唯一的值来标记以让 Vue 区分它们，否则 Vue 为了效率只会替换相同标签内部的内容。即使在技术上没有必要，**给在 \<transition> 组件中的多个元素设置 key 是一个更好的实践。**



![1557164369080](assets/1557164369080.png)



有动画了，但有问题



![1557164416985](assets/1557164416985.png)



同时生效的进入和离开的过渡不能满足所有要求，所以 Vue 提供了 **过渡模式**

- `in-out`：新元素先进行过渡，完成之后当前元素过渡离开。
- `out-in`：当前元素先进行过渡，完成之后新元素过渡进入。

用 `out-in` 重写之前的开关按钮过渡：



多个组件的过度：

```
<transition name="component-fade" mode="out-in">
  <component v-bind:is="view"></component>=====
</transition>

new Vue({
  el: '#transition-components-demo',
  data: {
    view: 'v-a'
  },
  components: {
    'v-a': {
      template: '<div>Component A</div>'
    },
    'v-b': {
      template: '<div>Component B</div>'
    }
  }
})
.component-fade-enter-active, .component-fade-leave-active {
  transition: opacity .3s ease;
}
.component-fade-enter, .component-fade-leave-to
/* .component-fade-leave-active for below version 2.1.8 */ {
  opacity: 0;
}
```

![1557164578371](assets/1557164578371.png)





## vue的列表过渡：

目前为止，关于过渡我们已经讲到：

- 单个节点
- 同一时间渲染多个节点中的一个

那么怎么同时渲染整个列表，比如使用 `v-for` ？在这种场景中，使用 `<transition-group>` 组件。在我们深入例子之前，先了解关于这个组件的几个特点：

- 不同于 `<transition>`，它会以一个真实元素呈现：默认为一个 `<span>`。你也可以通过 `tag` 特性更换为其他元素。
- [过渡模式](https://cn.vuejs.org/v2/guide/transitions.html#过渡模式)不可用，因为我们不再相互切换特有的元素。
- 内部元素 **总是需要** 提供唯一的 `key` 属性值。

```js
<div id="list-demo" class="demo">
  <button v-on:click="add">Add</button>
  <button v-on:click="remove">Remove</button>
  <transition-group name="list" tag="p">
    <span v-for="item in items" v-bind:key="item" class="list-item">
      {{ item }}
    </span>
  </transition-group>
</div>
new Vue({
  el: '#list-demo',
  data: {
    items: [1,2,3,4,5,6,7,8,9],
    nextNum: 10
  },
  methods: {
    randomIndex: function () {
      return Math.floor(Math.random() * this.items.length)
    },
    add: function () {
      this.items.splice(this.randomIndex(), 0, this.nextNum++)
    },
    remove: function () {
      this.items.splice(this.randomIndex(), 1)
    },
  }
})
.list-item {
  display: inline-block;
  margin-right: 10px;
}
.list-enter-active, .list-leave-active {
  transition: all 1s;
}
.list-enter, .list-leave-to
/* .list-leave-active for below version 2.1.8 */ {
  opacity: 0;
  transform: translateY(30px);
}
```



列表的排序过度：v-move

`<transition-group>` 组件还有一个特殊之处。不仅可以进入和离开动画，还可以改变定位。要使用这个新功能只需了解新增的  **v-move  特性**，它会在元素的改变定位的过程中应用。像之前的类名一样，可以通过 `name` 属性来自定义前缀，也可以通过 `move-class` 属性手动设置。

`v-move` 对于设置过渡的切换时机和过渡曲线非常有用，你会看到如下的例子：

```js
<script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.14.1/lodash.min.js"></script>

<div id="flip-list-demo" class="demo">
  <button v-on:click="shuffle">Shuffle</button>
  <transition-group name="flip-list" tag="ul">
    <li v-for="item in items" v-bind:key="item">
      {{ item }}
    </li>
  </transition-group>
</div>
new Vue({
  el: '#flip-list-demo',
  data: {
    items: [1,2,3,4,5,6,7,8,9]
  },
  methods: {
    shuffle: function () {
      this.items = _.shuffle(this.items)
    }
  }
})
.flip-list-move {
  transition: transform 1s;
}
```



## vue的动画封装

过渡可以通过 Vue 的组件系统实现复用。要创建一个可复用过渡组件，你需要做的就是将 `<transition>` 或者 `<transition-group>` 作为根组件，然后将任何子组件放置在其中就可以了。

使用 template 的简单例子：

```js
ue.component('my-special-transition', {
  template: '\
    <transition\
      name="very-special-transition"\
      mode="out-in"\
      v-on:before-enter="beforeEnter"\
      v-on:after-enter="afterEnter"\
    >\
      <slot></slot>\
    </transition>\
  ',
  methods: {
    beforeEnter: function (el) {
      // ...
    el.style.color=.....
    },
        
    afterEnter: function (el) {
      // ...
    }
  }
})
```

![1557165556920](assets/1557165556920.png)

![1557165772949](assets/1557165772949.png)





# 6项目预热

1.nodejs

2,gitee

下载项目到本地 git clone 地址

3,git

4，vue-cli





git status  

add .

git commit -m





![1557168843739](assets/1557168843739.png)



package.json 第三方模块依赖  -lock 锁文件

license：开源协议的说明

index.html  项目默认的模板文件

.postcss  对postcss的配置项

.gitignore git上传默认忽视

.eslintrc 代码规范

.eslintig 某些文件不会eslink检测

.editorconfig 配置了编辑器的语法

.babelrc  引入babel语法解析器

static 静态资源

src 整个项目源代码

![1557169515737](assets/1557169515737.png)

mian.js 入口文件

app.vue  项目原始的根组件

asset 资源





node 依赖包

config  项目的配置文件 index.js基础   dev.env.js 开发环境  prod.env.js线上环境

build  项目打包的webpack配置内容





## 单文件组件和vue中的路由

html

```html
<script src="https://unpkg.com/vue/dist/vue.js"></script>
<script src="https://unpkg.com/vue-router/dist/vue-router.js"></script>

<div id="app">
  <h1>Hello App!</h1>
  <p>
    <!-- 使用 router-link 组件来导航. -->
    <!-- 通过传入 `to` 属性指定链接. -->
    <!-- <router-link> 默认会被渲染成一个 `<a>` 标签 -->
    <router-link to="/foo">Go to Foo</router-link>
    <router-link to="/bar">Go to Bar</router-link>
  </p>
  <!-- 路由出口 -->
  <!-- 路由匹配到的组件将渲染在这里 -->
  <router-view></router-view>
</div>
```





js

```vue
// 0. 如果使用模块化机制编程，导入Vue和VueRouter，要调用 Vue.use(VueRouter)

// 1. 定义 (路由) 组件。
// 可以从其他文件 import 进来
const Foo = { template: '<div>foo</div>' }
const Bar = { template: '<div>bar</div>' }
// 2. 定义路由
// 每个路由应该映射一个组件。 其中"component" 可以是
// 通过 Vue.extend() 创建的组件构造器，
// 或者，只是一个组件配置对象。
// 我们晚点再讨论嵌套路由。
const routes = [
{ path: '/foo', component: Foo },
{ path: '/bar', component: Bar }
]
// 3. 创建 router 实例，然后传 `routes` 配置
// 你还可以传别的配置参数, 不过先这么简单着吧。
const router = new VueRouter({
routes // (缩写) 相当于 routes: routes
})
// 4. 创建和挂载根实例。
// 记得要通过 router 配置参数注入路由，
// 从而让整个应用都有路由功能
const app = new Vue({
router
}).$mount('#app')
// 现在，应用已经启动了！
```

通过注入路由器，我们可以在任何组件内通过 `this.$router` 访问路由器，也可以通过 `this.$route` 访问当前路由：

```vue
// Home.vue
export default {
  computed: {
    username () {
      // 我们很快就会看到 `params` 是什么
      return this.$route.params.username
    }
  },
  methods: {
    goBack () {
      window.history.length > 1
        ? this.$router.go(-1)
        : this.$router.push('/')
    }
  }
}
```





多页应用和单页应用

![1557170622381](assets/1557170622381.png)



跳转

![1557170738027](assets/1557170738027.png)



![1557170780193](assets/1557170780193.png)





## 项目代码初始化 



1meta 手机端，禁止放大，1：1

2引入css

![1557171191272](assets/1557171191272.png)



3引入 多倍屏的css，1px,物理像素边

4，click延迟300ms   npm install fastclick --save

5，iconfont

https://www.iconfont.cn/manage/index?spm=a313x.7781069.1998910419.11&manage_type=myprojects&projectId=1177433&keyword=





# 7首页开发

## 首页header区域的开发

install stylus --save

install stylus-loader --save    

以上可用可不用



```js
<template>
    <div class="header">
        <div class="header-left">返回</div>
        <div class="header-input">内容</div>
        <div class="header-right">城市</div>
    </div>
</template>
<script>
export default {
  name: 'HomeHeader',
};
</script>
<style scoped lang="scss">
.header{
    display: flex;
    height: .86rem;
    background-color: #00bcd4;
    color: #fff;
    .header-left {
        width: .64rem;
        float: left;

        height: .86rem;
        line-height: .86rem;

    }
    .header-input {
        flex:1;
        height: .64rem;
        line-height: .64rem;
        margin-top: .12rem;
        margin-left: .2rem;
        background-color: #fff;
        border-radius: .1rem;
        color: #ccc;
    }
    .header-right {
        width: 1.24rem;
        float: right;
        text-align: center;

         height: .86rem;
        line-height: .86rem;

    }
}

</style>

```



## iconfont的使用和代码优化

**iconfont**

icon 选好图标，购物车=》下载  ，放置 

引入文件：

main.js

![1557217193363](assets/1557217193363.png)

引用：

![1557217148879](assets/1557217148879.png)



**代码优化**

1css的通用参数，变量化 的定义变量

新建文件 加入变量

![1557217256077](assets/1557217256077.png)



引用：



![1557217284984](assets/1557217284984.png)



2  @/文件名     ~@/文件名   的使用

使代码简化

![1557217413186](assets/1557217413186.png)



重启服务器







## 首页轮播图

新建分支：github创建分支

git pull 分支拉到本地

切换 分支到 index-swiper



vue-awesome

![1557219235610](assets/1557219235610.png)

cnpm install vue-awesome-swiper@2.6.7 --save

https://github.com/surmon-china/vue-awesome-swiper

![1557219297618](assets/1557219297618.png)



新建swiper文件

 ![1557219343502](assets/1557219343502.png)

![1557219371166](assets/1557219371166.png)

插入图片

![1557219402571](assets/1557219402571.png)

图片宽高调整：

![1557219435608](assets/1557219435608.png)

问题：

test文字抖动：

swiper外加div 

![1557219538892](assets/1557219538892.png)

​				background：#fff

首页引入：

 



swiper.vue





问题没法修饰上：被scoped限制了

![1557219803326](assets/1557219803326.png)



修改后

   ![1557219862772](assets/1557219862772.png)





添加点：传递class的名字



![1557219943623](assets/1557219943623.png)





![1557219886341](assets/1557219886341.png)



往前拖白色，做循环

![1557219989328](assets/1557219989328.png)



自己的问题

1

![1557232112320](assets/1557232112320.png)

id的值重复

2

![1557232147547](assets/1557232147547.png)



未处理



git add .

git commit -m ""

git push

git checkout master

git merge origin/index-swiper



git push







## 图标区域的页面布局





创建新分支：index-icons

git pull

git checkout index-icons

 

```php+HTML
<template>
  <div class="icons">
    <div class="icon">
      <div class="icon-img">
        <img
          class="icon-img-content"
          src="http://img1.qunarzz.com/piao/fusion/1611/54/ace00878a52d9702.png"
          alt
        >
      </div>
      <p class="icon-desc">热门景点</p>
    </div>
  </div>
</template>
<script>
export default {
  name: "HomeIcons"
};
</script>
<style scoped lang="scss">
@import '../assets/styles/varibles.scss';
.icons {
  overflow: hidden;
  height: 0;
  padding-bottom: 50%;
//   background: green;

  .icon {
    float: left;
    width: 25%;
    overflow: hidden;
    padding-bottom: 25%;
    // background: red;
    position: relative;
    // aaa
    height: 0;
    .icon-img {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0.44rem;
    //   background-color: blue;

      box-sizing: border-box;
    //   background: blue;
      padding: 0.1rem;
      .icon-img-content {
        height: 100%;
        display: block;
        margin: 0 auto;
        height: 100%;
      }
      
    }
    .icon-desc {
        position: absolute;
        
        left: 0;
        right: 0;
        bottom: 0;
        height: .44rem;
        line-height: .44rem;
        color: $darkTextColor;
        text-align: center;
      }
  }
}
</style>

```





## 图标区域逻辑实现：







```
<template>
  <div class="icons">
    <swiper>
      <swiper-slide v-for="(page,index) in pages" :key="index">
        <div class="icon" v-for="item in page" :key="item.id">
          <div class="icon-img">
            <img class="icon-img-content" :src="item.imgSrc" alt>
          </div>

          <p class="icon-desc">{{item.desc}}</p>
        </div>
      </swiper-slide>
    </swiper>
  </div>
</template>


<script>
export default {
  name: "HomeIcons",
  data() {
    return {
      imgLists: [
        {
          id: "1",
          desc: "景点门票",
          imgSrc:
            "http://img1.qunarzz.com/piao/fusion/1611/54/ace00878a52d9702.png"
        },
        {
          id: "2",
          desc: "景点门票",
          imgSrc:
            "http://img1.qunarzz.com/piao/fusion/1611/54/ace00878a52d9702.png"
        },
        {
          id: "3",
          desc: "景点门票",
          imgSrc:
            "http://img1.qunarzz.com/piao/fusion/1611/54/ace00878a52d9702.png"
        },
        {
          id: "4",
          desc: "景点门票",
          imgSrc:
            "http://img1.qunarzz.com/piao/fusion/1611/54/ace00878a52d9702.png"
        },

        {
          id: "5",
          desc: "景点门票",
          imgSrc:
            "http://img1.qunarzz.com/piao/fusion/1611/54/ace00878a52d9702.png"
        },
        {
          id: "6",
          desc: "景点门票",
          imgSrc:
            "http://img1.qunarzz.com/piao/fusion/1611/54/ace00878a52d9702.png"
        },
        {
          id: "7",
          desc: "景点门票",
          imgSrc:
            "http://img1.qunarzz.com/piao/fusion/1611/54/ace00878a52d9702.png"
        },
        {
          id: "8",
          desc: "景点门票",
          imgSrc:
            "http://img1.qunarzz.com/piao/fusion/1611/54/ace00878a52d9702.png"
        },
        {
          id: "9",
          desc: "景点门票",
          imgSrc:
            "http://img1.qunarzz.com/piao/fusion/1611/54/ace00878a52d9702.png"
        }
      ]
    };
  },
  //===========================
  computed: {
    pages() {
      const pages = [];
      this.imgLists.forEach((item, index) => {
        const page = Math.floor(index / 8);
        if (!pages[page]) {
          pages[page] = [];
        }
        pages[page].push(item);
      });
      return pages;
    }
  }
};
</script>
<style scoped lang="scss">
@import "../assets/styles/varibles.scss";
.icons >>> .swiper-container {
  //   overflow: hidden;
  height: 0;
  padding-bottom: 50%;
  //   background: green;
}

.icon {
  float: left;
  width: 25%;
  overflow: hidden;
  padding-bottom: 25%;
  // background: red;
  position: relative;
  // aaa
  height: 0;
  .icon-img {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0.44rem;
    //   background-color: blue;

    box-sizing: border-box;
    //   background: blue;
    padding: 0.1rem;
    .icon-img-content {
      height: 100%;
      display: block;
      margin: 0 auto;
      height: 100%;
    }
  }
  .icon-desc {
    position: absolute;

    left: 0;
    right: 0;
    bottom: 0;
    height: 0.44rem;
    line-height: 0.44rem;
    color: $darkTextColor;
    text-align: center;

    //文字多省略============================
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
  }
}
</style>

```





git add .

git commit -m ""

git push

git checkout master

git merge origin/index-swiper



git push







## 推荐组件开发：



```vue

<template>
  <div>
    <div class="title">热销推荐</div>
    <ul>
      <li class="item" v-for="item in recommendList" :key="item.id">
        <img :src="item.imgUrl" alt class="item-img">

        <div class="item-info">
          <p class="item-title">{{item.title}}</p>
          <p class="item-desc">{{item.desc}}</p>
          <button class="item-button">查看详情</button>
        </div>
      </li>
    </ul>
 

  </div>
</template>
<script>
export default {
  name: "HomeRecommend",
  data() {
    return {
      recommendList: [
        {
          id: "1",
          imgUrl:
            "http://img1.qunarzz.com/sight/p0/1409/19/adca619faaab0898245dc4ec482b5722.jpg_140x140_80f63803.jpg",
          title: "故宫",
          desc: "东方宫殿建筑代表，世界宫殿建筑典范"
        },
        {
          id: "2",
          imgUrl:
            "http://img1.qunarzz.com/sight/p0/1409/19/adca619faaab0898245dc4ec482b5722.jpg_140x140_80f63803.jpg",
          title: "故宫",
          desc: "东方宫殿建筑代表，世界宫殿建筑典范"
        },
        {
          id: "3",
          imgUrl:
            "http://img1.qunarzz.com/sight/p0/1409/19/adca619faaab0898245dc4ec482b5722.jpg_140x140_80f63803.jpg",
          title: "故宫",
          desc: "东方宫殿建筑代表，世界宫殿建筑典范"
        },
        {
          id: "4",
          imgUrl:
            "http://img1.qunarzz.com/sight/p0/1409/19/adca619faaab0898245dc4ec482b5722.jpg_140x140_80f63803.jpg",
          title: "故宫",
          desc: "东方宫殿建筑代表，世界宫殿建筑典范"
        }
      ]
    };
  }
};
</script>
<style lang="scss" scoped>
.title {
  margin-top: 0.2rem;
  line-height: 0.8rem;
  background: #eee;
  text-indent: 0.2rem;
}
.item {
  overflow: hidden;
  display: flex;
  height: 1.9rem;

  // background-color: red;
  .item-img {
    width: 1.7rem;
    height: 1.7rem;
    padding: 0.1rem;
  }
  .item-info {
    flex: 1;
    padding: 0.1rem;
  
    .item-title {
      line-height: 0.54rem;
      font-size: 0.32rem;
      text-align: left;
   

      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
    }
    .item-desc {
      line-height: 0.4rem;
      color: #ccc;
      text-align: left;

      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
    }
    .item-button {
      line-height: 0.44rem;
      margin-top: 0.16rem;
      background: #ff9300;
      padding: 0 0.2rem;
      border-radius: 0.06rem;
      color: #fff;
      
    }
  }
}


</style>
```









## ajax 获取首页数据：axios

创建分支 index-ajax



axios 

安装：cnpm install axios --save

引入 home。vue  

只有static的文件内容可以访问

不提交 ：.gitignore  加入public/mock

 



替换路径



![1557330413879](assets/1557330413879.png)



添加vue.config.js文件：

```js
module.exports = {
  /** 区分打包环境与开发环境
   * process.env.NODE_ENV==='production'  (打包环境)
   * process.env.NODE_ENV==='development' (开发环境)
   * baseUrl: process.env.NODE_ENV==='production'?"https://cdn.didabisai.com/front/":'front/',
   */
  // 项目部署的基础路径
  // 我们默认假设你的应用将会部署在域名的根部,
  // 例如 https://www.my-app.com/
  // 如果你的应用部署在一个子路径下，那么你需要在这里
  // 指定子路径。比如将你的应用部署在
  // https://www.foobar.com/my-app/
  // 那么将这个值改为 '/my-app/'
  baseUrl: '/', // 构建好的文件输出到哪里

  outputDir: 'dist', // where to put static assets (js/css/img/font/...) // 是否在保存时使用‘eslint-loader’进行检查 // 有效值: true | false | 'error' // 当设置为‘error’时，检查出的错误会触发编译失败
  lintOnSave: true, // 使用带有浏览器内编译器的完整构建版本 // https://vuejs.org/v2/guide/installation.html#Runtime-Compiler-vs-Runtime-only
  runtimeCompiler: false, // babel-loader默认会跳过`node_modules`依赖. // 通过这个选项可以显示转译一个依赖
  transpileDependencies: [
    /* string or regex */
  ], // 是否为生产环境构建生成sourceMap?

  productionSourceMap: false, // 调整内部的webpack配置. // see https://github.com/vuejs/vue-cli/blob/dev/docs/webpack.md
  chainWebpack: () => {},
  configureWebpack: () => {}, // CSS 相关选项
  css: {
    // 将组件内部的css提取到一个单独的css文件（只用在生产环境）
    // 也可以是传递给 extract-text-webpack-plugin 的选项对象
    extract: true, // 允许生成 CSS source maps?
    sourceMap: false, // pass custom options to pre-processor loaders. e.g. to pass options to // sass-loader, use { sass: { ... } }
    loaderOptions: {}, // Enable CSS modules for all css / pre-processor files. // This option does not affect *.vue files.
    modules: false,
  }, // use thread-loader for babel & TS in production build // enabled by default if the machine has more than 1 cores

  //   parallel: require('os').cpus().length > 1,
  // PWA 插件相关配置 // see https://github.com/vuejs/vue-cli/tree/dev/packages/%40vue/cli-plugin-pwa

  pwa: {}, // configure webpack-dev-server behavior
  devServer: {
    open: process.platform === 'darwin',
    disableHostCheck: false,
    host: '0.0.0.0',
    port: 8088,
    https: false,
    hotOnly: false, // See https://github.com/vuejs/vue-cli/blob/dev/docs/cli-service.md#configuring-proxy
    proxy: null, // string | Object
    // before: app => {}
  }, // 第三方插件配置

  pluginOptions: {
    // ...
  },
};

```

api 转地址 到public/api

```js
module.exports = {
  devServer: {
    proxy: {
      "/api": {
        target: "http://localhost:8080",
        changeOrigin: true, // needed for virtual hosted sites
        ws: true, // proxy websockets
        pathRewrite: {
          "^/api": "/api"
        }
      }
    }
  }
};

```





首页父子组件数据传递



![1557332437310](assets/1557332437310.png)





![1557332451154](assets/1557332451154.png)





将其他文件：

![1557332485316](assets/1557332485316.png)





![1557332476820](assets/1557332476820.png)



weekend 修改 

![1557332542129](assets/1557332542129.png)



swiper bug

自动滚动：关闭

![1557332764752](assets/1557332764752.png)



![1557332755668](assets/1557332755668.png)





# ====

git add .

git commit -m ""

git push

git checkout master

git merge origin/index-swiper



git push





# 8城市列表页面开发

## 城市选择页面路由配置

创建分支 city-router



创建router

router.js

![1557333677898](assets/1557333677898.png)



新建文件City.vue

![1557333707024](assets/1557333707024.png)



router-link

header.vue

![1557333752159](assets/1557333752159.png)





```vue
<template>
  <div class="header">
    城市选择
    <router-link to="/">
      <div class="iconfont header-back">&#xe624;</div>
    </router-link>
  </div>
</template>
<script>
export default {
  name: "CityHeader"
};
</script>
<style lang="scss" scoped>
@import '../assets/styles/varibles.scss';
.header {
  position: relative;
  overflow: hidden;
  height: $headerHeight;
  line-height: $headerHeight;
  text-align: center;
  color: #fff;
  background: $bgcolor;
  font-size: .32rem;
  .header-back {
    position: absolute;
    top: 0;
    left: 0;
    width: .64rem;
    text-align: center;
    font-size: .4rem;
    color: #fff;
  }

}

</style>
```





## 搜索框布局：

```js
@import "../assets/styles/varibles.scss";
.search {
  height: 0.72rem;
  padding: 0 0.1rem;
  background: $bgcolor;
  .search-input {
    box-sizing: border-box;
    width: 100%;
    height: 0.62rem;
    padding: 0 0.1rem;
    line-height: 0.62rem;
    text-align: center;
    border-radius: 0.06rem;
    color: #666;
  }
 
}


 .search-content {
    // height: 1rem;  
    z-index: 1;
    overflow: hidden;
    position: absolute;
    top: 1.58rem;
    left: 0;
    right: 0;
    bottom: 0;
    background: #eee;
    .search-item {
      line-height: 0.62rem;
      padding-left: 0.2rem;
      background: #fff;
      color: #666;
    }
  }

```







## 列表布局：

```

<template>
  <div class="list" ref="wrapper">
    <div>
      <div class="area">
        <div class="title border-topbottom">当前城市</div>
        <div class="button-list">
          <div class="button-wrapper">
            <div class="button">thiscurrentCity</div>
          </div>
        </div>
      </div>
      <div class="area">
        <div class="title border-topbottom">热门城市</div>
        <div class="button-list">
          <div class="button-wrapper">
            <div class="button">item.name</div>
          </div>
        </div>
      </div>
      <div class="area">
        <div class="title border-topbottom">A</div>
        <div class="item-list">
          <div class="item border-bottom">innerItem.name</div>
          <div class="item border-bottom">innerItem.name</div>
          <div class="item border-bottom">innerItem.name</div>
          <div class="item border-bottom">innerItem.name</div>
          <div class="item border-bottom">innerItem.name</div>
          <div class="item border-bottom">innerItem.name</div>
          <div class="item border-bottom">innerItem.name</div>
          <div class="item border-bottom">innerItem.name</div>
          <div class="item border-bottom">innerItem.name</div>
        </div>
      </div>
      <div class="area">
        <div class="title border-topbottom">A</div>
        <div class="item-list">
          <div class="item border-bottom">innerItem.name</div>
          <div class="item border-bottom">innerItem.name</div>
          <div class="item border-bottom">innerItem.name</div>
          <div class="item border-bottom">innerItem.name</div>
          <div class="item border-bottom">innerItem.name</div>
          <div class="item border-bottom">innerItem.name</div>
          <div class="item border-bottom">innerItem.name</div>
          <div class="item border-bottom">innerItem.name</div>
          <div class="item border-bottom">innerItem.name</div>
        </div>
      </div>
      <div class="area">
        <div class="title border-topbottom">B</div>
        <div class="item-list">
          <div class="item border-bottom">innerItem.name</div>
          <div class="item border-bottom">innerItem.name</div>
          <div class="item border-bottom">innerItem.name</div>
          <div class="item border-bottom">innerItem.name</div>
          <div class="item border-bottom">innerItem.name</div>
          <div class="item border-bottom">innerItem.name</div>
          <div class="item border-bottom">innerItem.name</div>
          <div class="item border-bottom">innerItem.name</div>
          <div class="item border-bottom">innerItem.name</div>
        </div>
      </div>
      
    </div>
  </div>
</template>
<script>
export default {
  name: "CityList"
};
</script>
<style lang="scss" scoped>
@import "../assets/styles/varibles.scss";
.border-topbottom {
  &:before {
    border-color: #ccc;
  }
  &:after {
    border-color: #ccc;
  }
}

.border-bottom {
  &:before {
    border-color: #ccc;
  }
}

.list {
  overflow: hidden;
  position: absolute;
  top: 1.58rem;
  left: 0;
  right: 0;
  bottom: 0;
  .title {
    line-height: 0.54rem;
    background: #eee;
    padding-left: 0.2rem;
    color: #666;
    font-size: 0.26rem;
  }
  .button-list {
    overflow: hidden;
    padding: 0.1rem 0.6rem 0.1rem 0.1rem;
    .button-wrapper {
      float: left;
      width: 33.33%;
      .button {
        margin: 0.1rem;
        padding: 0.1rem 0;
        text-align: center;
        border: 0.02rem solid #ccc;
        border-radius: 0.06rem;
      }
    }
  }
  .item-list {
    .item {
      line-height: 0.76rem;
      padding-left: 0.2rem;
    }
  }
}
</style>
```



## better-scorll的使用及字母表布局：

安装：cnpm install better-scroll --save

引入

![1557339715827](assets/1557339715827.png)



ref

![1557339726876](assets/1557339726876.png)





字母表：

```vue
<template>
  <ul class="list">
    <li class="item">a</li>
    <li class="item">b</li>
    <li class="item">c</li>
    <li class="item">d</li>
    <li class="item">e</li>
  </ul>
</template>
<script>
export default {
  name: "CityAlphabet"
};
</script>
<style lang="scss" scoped>
@import "../assets/styles/varibles.scss";
.list {

  display: flex;
  
  flex-direction: column;
  justify-content: center;

  position: absolute;
  top: 1.58rem;
  right: 0;
  bottom: 0;
  width: 0.4rem;
  .item {
    line-height: 0.4rem;
    text-align: center;
    color: $bgcolor;
  }
}
</style>
```



## 页面的动态渲染





引入axio

city.vue

![1557342233469](assets/1557342233469.png)



![1557342240610](assets/1557342240610.png)

citylist.vue

![1557342336281](assets/1557342336281.png)





![1557342344112](assets/1557342344112.png)

cityalphabet.vue



![1557342354288](assets/1557342354288.png)



![1557342362985](assets/1557342362985.png)





## 兄弟组件间的联动：

创建分支：

city-components



![1557386956713](assets/1557386956713.png)



滑动：8-615.35

```js
<script>
export default {
  name: "CityAlphabet",
  props: {
    cities: Object
  },
  data() {
    return {
      touchStatus: false,
      startY: 0,
      timer: null
    };
  },
  computed: {
    letters() {
      const letters = [];
      for (let i in this.cities) {
        letters.push(i);
      }
      return letters; //['a','b','c']
    },
    updated() {
      
    }
  },
  methods: {
    handleLetterClick(e) {
      this.$emit("change", e.target.innerText);
      // console.log(e.target.innerText)
    },
    handleTouchStart() {
      this.touchStatus = true;
    },
    handleTouchMove(e) {
      // console.log(startY)
      if (this.touchStatus) {
        if (this.timer) {
          clearTimeout(this.timer);
        }
        this.timer = setTimeout(() => {
            this.startY = this.$refs["A"][0].offsetTop;
          const touchY = e.touches[0].clientY - 79;
          //   console.log(touchY)
          console.log(this.startY);
          const index = Math.floor((touchY - this.startY) / 20);
          //   console.log(index)
          if (index >= 0 && index < this.letters.length) {
            this.$emit("change", this.letters[index]);
          }
        }, 16);
      }
    },

    handleTouchEnd() {
      this.touchStatus = false;
    }
  }
};
</script>
```





## 列表切换性能优化

第一步

![1557387079546](assets/1557387079546.png)



```
updated () {
    this.startY = this.$refs['A'][0].offsetTop
  },
```



第二 函数节流

定义timer

减少 函数 的执行频率



```
  handleTouchMove (e) {
      if (this.touchStatus) {
        if (this.timer) {
          clearTimeout(this.timer)
        }
        this.timer = setTimeout(() => {
          const touchY = e.touches[0].clientY - 79
          const index = Math.floor((touchY - this.startY) / 20)
          if (index >= 0 && index < this.letters.length) {
            this.$emit('change', this.letters[index])
          }
        }, 16)
      }
    },
```





## 搜索功能实现









```js
.search-content {
    // height: 1rem;  
    z-index: 1;
    overflow: hidden;
    position: absolute;
    top: 1.58rem;
    left: 0;
    right: 0;
    bottom: 0;
    background: #eee;
    .search-item {
      line-height: 0.62rem;
      padding-left: 0.2rem;
      background: #fff;
      color: #666;
    }
  }
```





功能代码：

![1557391997849](assets/1557391997849.png)



![1557392011521](assets/1557392011521.png)

```vue
 watch: {
    keyword() {
      if (this.timer) {
        clearTimeout(this.timer);
      }
      if (!this.keyword) {
        this.list = [];
        return;
      }
      this.timer = setTimeout(() => {
        const result = [];
        for (let i in this.cities) {
          this.cities[i].forEach(value => {
            if (
              value.spell.indexOf(this.keyword) > -1 ||
              value.name.indexOf(this.keyword) > -1
            ) {
              result.push(value);
            }
          });
        }
        this.list = result;
      }, 100);
    }
  }
```



```css
.search-content {
  // height: 1rem;
  z-index: 1;
  overflow: hidden;
  position: absolute;
  top: 1.58rem;
  left: 0;
  right: 0;
  bottom: 0;
  background: #eee;
  .search-item {
    line-height: 0.62rem;
    padding-left: 0.2rem;
    background: #fff;
    color: #666;
  }
}
```



滚动实现：

引入

![1557392113045](assets/1557392113045.png)

mounted：



![1557392126795](assets/1557392126795.png)



闯传入ref

如过没有：

![1557392195296](assets/1557392195296.png)

![1557392219546](assets/1557392219546.png)





有值显示 无值隐藏

![1557392719147](assets/1557392719147.png)





##  使用Vuex实现数据共享

点击城市，首页的城市按钮改变



去掉home cities

homeheader 里 props 去掉 ==》

![1557393735434](assets/1557393735434.png)



citylist 



![1557393774647](assets/1557393774647.png)





store.js

```
import Vue from "vue";
import Vuex from "vuex";

Vue.use(Vuex);

export default new Vuex.Store({
  state: {
    city: "上海"
  },

  mutations: {
    changeCity(state, city) {
      state.city = city
    }
  },
  actions: {
    changeCity(ctx, city) {
      // console.log(city)
      ctx.commit("changeCity", city);
    }
  }
});

```

```
 methods: {
    handleCityClick(city) {
      // this.changeCity(city);
      this.$store.commit('changeCity',city)
      this.$router.push("/");
      // console.log(city)
    }
  },
```



citylist:



![1557394969938](assets/1557394969938.png)



citysearch

![1557395195296](assets/1557395195296.png)



![1557395204484](assets/1557395204484.png)



跳转：

编程式

![1557395216353](assets/1557395216353.png)





## vuex的高级使用及localstorage



bug，刷新，显示上海





![1557395532207](assets/1557395532207.png)



抛出异常



![1557404301484](assets/1557404301484.png)



首页地址太长，会少

![1557404491487](assets/1557404491487.png)





homeheader 代码优化

![1557404854566](assets/1557404854566.png)





![1557404867704](assets/1557404867704.png)





citylist



![1557408413251](assets/1557408413251.png)





![1557408432130](assets/1557408432130.png)



city search；



![1557408724247](assets/1557408724247.png)

getter的使用

![1557409123080](assets/1557409123080.png)







![1557409137925](assets/1557409137925.png)



store

![1557409149378](assets/1557409149378.png)





module





## keep-alive 优化网页性能

每次路由切换ajax都请求一次



![1557409939682](assets/1557409939682.png)



更改首页数据内容



![1557410154715](assets/1557410154715.png)



![1557410172793](assets/1557410172793.png)





![1557410228345](assets/1557410228345.png)



每次页面加载：home.vue

![1557410320851](assets/1557410320851.png)









# 详情页面开发

## 详情也动态路由及banner布局





router-link会把 默认为a标签 颜色改变

将li标签改成router-link

![1557412279221](assets/1557412279221.png)



动态绑定

![1557412444072](assets/1557412444072.png)







## 公用图片画廊组件的拆分



gallery.vue

打开轮播图 

关闭

gallery

![1557415570654](assets/1557415570654.png)



![1557415728814](assets/1557415728814.png)



![1557415641905](assets/1557415641905.png)

detailbanner

![1557415689270](assets/1557415689270.png)



![1557415844684](assets/1557415844684.png)



![1557415919420](assets/1557415919420.png)

有问题 swiper宽度计算问题

![1557415457619](assets/1557415457619.png)





监听到dom改变，刷新一次









## 实现Header渐隐渐显效果

header 往下 出现，向上隐藏



![1557416956764](assets/1557416956764.png)





![1557416975585](assets/1557416975585.png)











## 对全局事件的解绑

![1557417090037](assets/1557417090037.png)



影响首页及其他了

![1557417139968](assets/1557417139968.png)



## 使用递归组件实现详情页列表============

![1557417620848](assets/1557417620848.png)





 问题， 上滑header没有遮住 下面

detail header

![1557417791628](assets/1557417791628.png)





## 使用ajax获取动态数据



![1557418818968](assets/1557418818968.png)



![1557418875294](assets/1557418875294.png)

或者

![1557418827799](assets/1557418827799.png)



![1557418911517](assets/1557418911517.png)



![1557418836919](assets/1557418836919.png)



![1557418983060](assets/1557418983060.png)

![1557418965387](assets/1557418965387.png)



propd接受：

![1557419861822](assets/1557419861822.png)





![1557419907437](assets/1557419907437.png)

mouted只会执行一次  。activated

回到首页，获取新的ajax 

除了detail都缓存

![1557419988591](assets/1557419988591.png)







name   递归组件/某页面取消缓存用到/

路由切换始终回到顶部：





## 在项目加入基础动画：



